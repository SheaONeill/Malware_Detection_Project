#!/bin/bash
#
#
# ssdeep aka fuzzy hashing
#
clear
echo -e "\nIn Fuzzy Hashing Now!"

#calculate hashes for check against database
#this needs to be just unrecognized files found
while read unrecognized
    do
        #calculate ssdeep fuzzy hash
        ssdeep  -r  ${unrecognized} > ${LOG_DIR}/ssdeep_hash.log
        #call read_hash_log_function.sh script and pass parameter ssdeep
        ${ABSOLUTE_PATH}/read_hash_log_function.sh ssdeep
        #check results from database log against benign log
        echo -e "\nChecking SSDeep Benign from Database"
        ssdeep -k ${LOG_DIR}/ssdeep_hash.log ${LOG_DIR}/ssdeep_benign_hashes.log
        echo
        #
        #check results from database log against malware log
        echo -e "\nChecking SSDeep Malware from Database"
        #reset colour
        echo "$(tput sgr0)"
        #set colour to red,bold
        echo "$(tput setaf 1)"
        echo "$(tput bold)"
        ssdeep -k ${LOG_DIR}/ssdeep_hash.log ${LOG_DIR}/ssdeep_malware_hashes.log
        echo
        #reset colour
        echo "$(tput sgr0)"
        
#get the input from the  unrecognized_hashes_paths.log these are the paths stripped     
done <${LOG_DIR}/unrecognized_hashes_paths.log
#wait for keypress
read -p "Press any key to continue" -n 1 -r


#ssdeep  -r  ${ABSOLUTE_PATH}/test_dir/* > ${LOG_DIR}/ssdeep_hash.log
#echo -e "\nDone!"
#cat ${LOG_DIR}/ssdeep_hash.log


#call read_hash_log_function.sh script and pass parameter ssdeep
#${ABSOLUTE_PATH}/read_hash_log_function.sh ssdeep
#check results from database log against benign log
#echo -e "\nChecking SSDeep Benign from Database"
#ssdeep -k ${LOG_DIR}/ssdeep_hash.log ${LOG_DIR}/ssdeep_benign_hashes.log
#
#check results from database log against malware log
#echo -e "\nChecking SSDeep Malware from Database"
#ssdeep -k ${LOG_DIR}/ssdeep_hash.log ${LOG_DIR}/ssdeep_malware_hashes.log

#to do
#ssdeep switches
#
#ssdeep -b <file1> > <generated-ssdeep-hash>
#
#test generated hases againt another file
#ssdeep -bm <generated-ssdeep-hash> <some-other-file>
#
#
#ssdeep -r <dir> > <generated-ssdeep-hashes>
#
#get <good-list-from-database> and <bad-list-from-database>then
# check against each other
#ssdeep  -x  <generated-ssdeep-hashes> <good-list-from-database>
#ssdeep  -x  <generated-ssdeep-hashes> <bad-list-from-database> 
#or
#ssdeep  -x  <generated-ssdeep-hashes>  <good-list-from-database> <bad-list-from-database> 
#
#comapre unknown signatures
#
#ssdeep -k <good-list-from-database> <generated-ssdeep-hashes>
#ssdeep -k <bad-list-from-database> <generated-ssdeep-hashes>
#ssdeep -k <good-list-from-database>  -k <bad-list-from-database> <generated-ssdeep-hashes>

