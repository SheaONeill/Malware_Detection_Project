#!/bin/bash
#
#
#
#

#call this function if its a dir to check and save md5 and filename results to hash.log
dir_to_check_function () {
    echo -e "\nSuggested Dir: ${ABSOLUTE_PATH}/test_dir/\n"
    echo -n "Enter the directory to check: "
    #uncomment next line to search for specific directory
	read scan_dir	
	#comment next line to search for specific directory
	#scan_dir="${ABSOLUTE_PATH}/test_dir/"
	echo -e "\nScan dir is $scan_dir"

	#
	#check if ssdeep
	if [ "${choice}" == "ssdeep_check" ]; then
	#
	#fuzzy or md5 check
    echo -e "\nChoice= $choice"
    exit 0
    fi
    #
	#find hashes of executables
	#need to get the path included for quarantine move
	find $scan_dir -type f -exec md5sum {} + > ${LOG_DIR}/hash.log
	#find . -name "*" -type f -executable | md5sum * > ${LOG_DIR}/hash.log
	echo -e "\nHash log find files directory results"
	cat ${LOG_DIR}/hash.log
	}

#call dir_to_check_function
dir_to_check_function
#call read_hash_log_function.sh script
${ABSOLUTE_PATH}/read_hash_log_function.sh $choice
